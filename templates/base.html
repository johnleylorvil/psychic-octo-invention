{% load static %}
<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- SEO Meta Tags -->
    <title>{% block title %}Afèpanou - Marketplace Haïtien pour la Croissance Économique{% endblock %}</title>
    <meta name="description" content="{% block description %}Découvrez Afèpanou, le marketplace haïtien qui soutient l'entrepreneuriat local. Produits authentiques, artisanats traditionnels et services diversifiés pour la croissance économique d'Haïti.{% endblock %}">
    <meta name="keywords" content="{% block keywords %}marketplace haïti, produits haïtiens, artisanat haïti, agriculture haïti, entrepreneuriat local, économie haïtienne{% endblock %}">
    <meta name="author" content="Afèpanou Marketplace">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{% block og_title %}Afèpanou - Marketplace Haïtien{% endblock %}">
    <meta property="og:description" content="{% block og_description %}Soutenez l'économie haïtienne avec des produits locaux authentiques{% endblock %}">
    <meta property="og:image" content="{% static 'images/og-image.jpg' %}">
    <meta property="og:url" content="{% block og_url %}{{ request.build_absolute_uri }}{% endblock %}">
    <meta property="og:type" content="website">
    <meta property="og:site_name" content="Afèpanou">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="{% block twitter_title %}Afèpanou - Marketplace Haïtien{% endblock %}">
    <meta name="twitter:description" content="{% block twitter_description %}Soutenez l'économie haïtienne{% endblock %}">
    <meta name="twitter:image" content="{% static 'images/twitter-card.jpg' %}">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'images/apple-touch-icon.png' %}">
    <link rel="icon" type="image/png" sizes="32x32" href="{% static 'images/favicon-32x32.png' %}">
    <link rel="icon" type="image/png" sizes="16x16" href="{% static 'images/favicon-16x16.png' %}">
    <link rel="manifest" href="{% static 'manifest.json' %}">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@400;500;600&family=Montserrat:wght@500;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer">
    
    <!-- Main Stylesheets -->
    <link rel="stylesheet" href="{% static 'css/main.css' %}">
    <link rel="stylesheet" href="{% static 'css/components.css' %}">
    
    <!-- Page Specific CSS -->
    {% block extra_css %}{% endblock %}
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#E67E22">
    <meta name="msapplication-TileColor" content="#E67E22">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{% block canonical_url %}{{ request.build_absolute_uri }}{% endblock %}">
    
    <!-- JSON-LD Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Afèpanou",
        "url": "{{ request.build_absolute_uri }}",
        "logo": "{% static 'images/logo.png' %}",
        "description": "Marketplace haïtien pour la croissance économique locale",
        "address": {
            "@type": "PostalAddress",
            "addressCountry": "HT",
            "addressRegion": "Ouest",
            "addressLocality": "Port-au-Prince"
        },
        "sameAs": [
            "https://facebook.com/afepanou",
            "https://instagram.com/afepanou",
            "https://twitter.com/afepanou"
        ]
    }
    </script>
    
    {% block extra_head %}{% endblock %}
</head>

<body class="{% block body_class %}{% endblock %}">
    <!-- Skip to main content -->
    <a href="#main-content" class="skip-link">Aller au contenu principal</a>
    
    <!-- Header -->
    {% include 'includes/header.html' %}
    
    <!-- Main Content -->
    <main id="main-content" role="main">
        {% block content %}{% endblock %}
    </main>
    
    <!-- Footer -->
    {% include 'includes/footer.html' %}
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay" aria-hidden="true">
        <div class="loading-spinner">
            <div class="spinner"></div>
            <p>Chargement...</p>
        </div>
    </div>
    
    <!-- Notification Container -->
    <div id="notification-container" class="notification-container" aria-live="polite" aria-atomic="true"></div>
    
    <!-- Cookie Notice -->
    <div id="cookie-notice" class="cookie-notice" role="dialog" aria-labelledby="cookie-title" aria-describedby="cookie-description">
        <div class="cookie-content">
            <h3 id="cookie-title">Utilisation des Cookies</h3>
            <p id="cookie-description">Nous utilisons des cookies pour améliorer votre expérience sur Afèpanou.</p>
            <div class="cookie-actions">
                <button class="btn btn-primary" id="accept-cookies">Accepter</button>
                <button class="btn btn-ghost" id="decline-cookies">Refuser</button>
                <a href="#" class="btn btn-ghost">En savoir plus</a>
            </div>
        </div>
    </div>
    
    <!-- Main JavaScript -->
    <script src="{% static 'js/main.js' %}"></script>
    
    <!-- Page Specific JavaScript -->
    {% block extra_js %}{% endblock %}
    
    <!-- Analytics (if enabled) -->
    {% if settings.GOOGLE_ANALYTICS_ID %}
    <script async src="https://www.googletagmanager.com/gtag/js?id={{ settings.GOOGLE_ANALYTICS_ID }}"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', '{{ settings.GOOGLE_ANALYTICS_ID }}');
    </script>
    {% endif %}
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('{% static "sw.js" %}')
                    .then(function(registration) {
                        console.log('SW registered: ', registration);
                    })
                    .catch(function(registrationError) {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>

<style>
/* Loading Overlay */
.loading-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 255, 255, 0.95);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 9999;
    backdrop-filter: blur(5px);
}

.loading-overlay.show {
    display: flex;
}

.loading-spinner {
    text-align: center;
    color: var(--primary-orange);
}

.spinner {
    width: 50px;
    height: 50px;
    border: 4px solid #f3f3f3;
    border-top: 4px solid var(--primary-orange);
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin: 0 auto 1rem;
}

@keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
}

/* Skip Link */
.skip-link {
    position: absolute;
    top: -40px;
    left: 6px;
    background: var(--primary-orange);
    color: white;
    padding: 8px;
    border-radius: 4px;
    text-decoration: none;
    z-index: 10000;
    transition: top 0.3s;
}

.skip-link:focus {
    top: 6px;
}

/* Notification Container */
.notification-container {
    position: fixed;
    top: 100px;
    right: 20px;
    z-index: 1000;
    max-width: 400px;
}

/* Cookie Notice */
.cookie-notice {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    background: var(--text-dark);
    color: white;
    padding: 1rem;
    z-index: 1000;
    transform: translateY(100%);
    transition: transform 0.3s ease;
}

.cookie-notice.show {
    transform: translateY(0);
}

.cookie-content {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1rem;
    flex-wrap: wrap;
}

.cookie-actions {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.cookie-actions .btn {
    padding: 0.5rem 1rem;
    font-size: 0.9rem;
}

/* Responsive Cookie Notice */
@media (max-width: 768px) {
    .cookie-content {
        flex-direction: column;
        text-align: center;
    }
    
    .cookie-actions {
        justify-content: center;
        width: 100%;
    }
}

/* Print Styles */
@media print {
    .skip-link,
    .loading-overlay,
    .notification-container,
    .cookie-notice {
        display: none !important;
    }
}
</style>