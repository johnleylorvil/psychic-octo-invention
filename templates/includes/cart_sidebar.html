<!-- templates/includes/cart_sidebar.html -->
{% load static %}

<!-- Overlay pour l'arrière-plan (s'assure que le reste de la page est désactivé quand le panier est ouvert) -->
<div id="cart-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden transition-opacity duration-300" aria-hidden="true"></div>

<!-- Conteneur principal du panier (Sidebar droite) -->
<aside id="cart-sidebar" class="fixed top-0 right-0 h-full w-full max-w-md bg-white shadow-xl z-50 transform translate-x-full transition-transform duration-300 ease-in-out overflow-hidden flex flex-col" role="dialog" aria-labelledby="cart-title" aria-modal="true" tabindex="-1">
    <div class="flex flex-col h-full">
        <!-- En-tête du panier -->
        <header class="flex items-center justify-between p-6 border-b border-light">
            <h2 id="cart-title" class="text-2xl font-bold text-dark">Votre Panier</h2>
            <button id="close-cart-btn" class="text-2xl text-muted hover:text-dark transition-colors duration-200" aria-label="Fermer le panier">
                <i class="fas fa-times"></i>
            </button>
        </header>

        <!-- Contenu du panier -->
        <div id="cart-items-container" class="flex-grow overflow-y-auto p-6">
            <!-- Message panier vide -->
            <div id="cart-empty-message" class="hidden text-center py-12">
                <i class="fas fa-shopping-cart text-5xl text-muted mb-4"></i>
                <h3 class="text-xl font-semibold text-dark mb-2">Votre panier est vide</h3>
                <p class="text-light mb-6">Découvrez nos produits et commencez vos achats !</p>
                <a href="{% url 'core:home' %}" class="btn btn-primary inline-flex items-center">
                    <i class="fas fa-store mr-2"></i> Explorer le Marketplace
                </a>
            </div>

            <!-- Liste des articles -->
            <div id="cart-items-list" class="space-y-6">
                <!-- Les articles du panier seront insérés ici dynamiquement par JavaScript -->
                <!-- Exemple d'un article (pour le style, sera remplacé dynamiquement) -->
                <!--
                <article class="cart-item flex border border-light rounded-xl overflow-hidden" data-cart-item-id="123">
                    <div class="cart-item-image w-24 bg-beige flex items-center justify-center flex-shrink-0">
                        <img src="{% static 'images/placeholder-product.jpg' %}" alt="Nom du Produit" class="w-full h-full object-cover">
                    </div>
                    <div class="cart-item-details flex-grow p-4">
                        <h3 class="cart-item-title font-medium text-dark mb-1">Nom du Produit</h3>
                        <p class="cart-item-price text-primary font-semibold text-lg mb-3">1 200 HTG</p>
                        <div class="cart-item-quantity flex items-center justify-between">
                            <div class="flex items-center border border-light rounded-full overflow-hidden">
                                <button type="button" class="decrease-qty px-3 py-1 text-lg hover:bg-beige transition-colors duration-200">-</button>
                                <span class="quantity-display px-3 py-1 text-center w-12">1</span>
                                <button type="button" class="increase-qty px-3 py-1 text-lg hover:bg-beige transition-colors duration-200">+</button>
                            </div>
                            <button type="button" class="remove-item text-muted hover:text-red-500 transition-colors duration-200" aria-label="Supprimer l'article">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                         <p class="cart-item-total text-dark font-semibold mt-2">Total: 1 200 HTG</p>
                    </div>
                </article>
                -->
            </div>
        </div>

        <!-- Résumé et actions du panier -->
        <footer id="cart-summary" class="border-t border-light p-6 bg-soft mt-auto">
            <div class="flex justify-between items-center mb-4">
                <span class="text-dark font-semibold">Sous-total:</span>
                <span id="cart-total-amount" class="text-2xl font-bold text-primary">0 HTG</span>
            </div>
            <p class="text-xs text-light mb-6">Les frais de livraison sont calculés à l'étape de paiement.</p>
            
            <div class="flex flex-col gap-3">
                <a href="#" id="checkout-btn" class="btn btn-primary w-full text-center">Procéder au Paiement</a>
                <button id="continue-shopping-btn" class="btn btn-outline w-full">Continuer vos Achats</button>
            </div>
        </footer>
    </div>
</aside>

<!-- Styles spécifiques pour le panier -->
<style>
/* Styles pour le panier */
#cart-overlay.show {
    display: block;
    opacity: 1;
}

#cart-sidebar.show {
    transform: translateX(0);
}

/* Style pour les articles du panier */
.cart-item {
    animation: fadeInUp 0.3s ease-out;
}

.cart-item-image {
    flex-shrink: 0; /* Empêche l'image de rétrécir */
}

.cart-item-title {
    font-size: var(--text-base);
    line-height: 1.4;
}

/* Placeholder pour les éléments dynamiques si JS est désactivé ou en cours de chargement */
#cart-items-list:empty::before {
    content: "Chargement du panier...";
    display: block;
    text-align: center;
    padding: var(--space-8);
    color: var(--text-light);
}

/* Responsive */
@media (max-width: 640px) {
    #cart-sidebar {
        max-width: 100%; /* Plein écran sur mobile */
    }
}

/* Animation pour les articles (si pas déjà définie dans main.css) */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Animation pour le badge du panier (si nécessaire) */
@keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
}
.animate-pulse {
    animation: pulse 0.5s ease-in-out;
}
</style>